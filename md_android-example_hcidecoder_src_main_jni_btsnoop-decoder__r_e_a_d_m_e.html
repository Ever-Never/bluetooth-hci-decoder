<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>hci-decoder: Bluetooth Snoop File streaming decoder</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">hci-decoder
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">Lightweight Bluetooth HCI decoder library parsing individually HCI frames into JSON format</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('md_android-example_hcidecoder_src_main_jni_btsnoop-decoder__r_e_a_d_m_e.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Bluetooth Snoop File streaming decoder </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>onSnoopPacketReceived</p>
<p><a href="https://travis-ci.org/akinaru/btsnoop-decoder">![Build Status](https://travis-ci.org/akinaru/btsnoop-decoder.svg?branch=master)</a> <a href="https://bintray.com/akinaru/generic/btsnoop-decoder/_latestVersion">![Download](https://api.bintray.com/packages/akinaru/generic/btsnoop-decoder/images/download.svg)</a> <a class="el" href="md__l_i_c_e_n_s_e.html">![License](http://img.shields.io/:license-mit-blue.svg)</a></p>
<p>Small library to decode Bluetooth Snoop file used to store radio packet records</p>
<ul>
<li>streaming enabled : incoming packet data can be decoded over the fly for the same snoop file</li>
<li>non-blocking or blocking process (thread task running)</li>
</ul>
<p>Note : this library doesnt decode HCI Bluetooth data, only snoop-like format</p>
<p><a href="CHANGELOG.md">ChangeLogs can be found here</a></p>
<h2>Documentation</h2>
<p><a href="http://akinaru.github.io/btsnoop-decoder">http://akinaru.github.io/btsnoop-decoder</a></p>
<h2>Build library</h2>
<p>``` cmake . make ```</p>
<p>Library release is under <code>lib</code> directory.</p>
<h2>Build test</h2>
<p>``` cd test cmake . make ```</p>
<p>Usage : ``` ./bin/btsnoop-test &lt;path to="" btsnoop="" file&gt;=""&gt; ```</p>
<h2>Decode non-dynamic Bt snoop file</h2>
<p>To decode one single bt snoop file with no streaming support, use <a class="el" href="class_bt_snoop_task.html">BtSnoopTask</a> with method :</p>
<p><code>bool <a class="el" href="class_bt_snoop_task.html#a5c25d44047a1d95d9e0ddd64fd9cc5a3" title="decode full snoop file header / packet record data ">BtSnoopTask::decode_file()</a></code></p>
<p>Exemple :</p>
<p>``` #include "btsnoop/btsnooptask.h"</p>
<p>.......... ..........</p>
<p><a class="el" href="class_bt_snoop_task.html">BtSnoopTask</a> decoder("/path/to/your/file");</p>
<p>bool success = decoder.decode_file();</p>
<p>if (success){ //success } else{ //failure (bad reading / file not found) } ```</p>
<h2>Decode dynamic Bt snoop file</h2>
<ul>
<li>To decode in streaming mode a bt snoop file, use <code><a class="el" href="class_bt_snoop_parser.html">BtSnoopParser</a></code> :</li>
</ul>
<p>``` #include "btsnoop/btsnoopparser.h"</p>
<p>.......... ..........</p>
<p><a class="el" href="class_bt_snoop_parser.html">BtSnoopParser</a> parser; ```</p>
<ul>
<li>Add a listner to monitor incoming packet data record with <code>void <a class="el" href="class_bt_snoop_parser.html#ae50effbb1a093e2dfe72574296d4fc69" title="add a listener to monitor streamed packet record ">BtSnoopParser::addSnoopListener(IBtSnoopListener* listener)</a></code>:</li>
</ul>
<p>``` <a class="el" href="class_bt_snoop_monitor.html">BtSnoopMonitor</a> monitor;</p>
<p>parser.addSnoopListener(&amp;monitor); ```</p>
<ul>
<li><code><a class="el" href="class_bt_snoop_monitor.html">BtSnoopMonitor</a></code> is a class inheriting <a class="el" href="class_i_bt_snoop_listener.html">IBtSnoopListener</a> interface</li>
</ul>
<p>``` class <a class="el" href="class_bt_snoop_monitor.html">BtSnoopMonitor</a> : public <a class="el" href="class_i_bt_snoop_listener.html">IBtSnoopListener</a> {</p>
<p>public: </p><pre class="fragment">BtSnoopMonitor();

~BtSnoopMonitor();

/**
 *   *      called when a new packet record has been received
 * @param fileInfo
 *      file info object
 * @param packet
 *      snoop packet record object
 */
void onSnoopPacketReceived(BtSnoopFileInfo fileInfo,BtSnoopPacket packet);
</pre><p>}; ```</p>
<ul>
<li>launch non blocking decoding task with :</li>
</ul>
<p><code>bool <a class="el" href="class_bt_snoop_parser.html#acb52a1796bba843c8c9b7e2eb69890e2" title="decode streaming file (non blocking method) ">BtSnoopParser::decode_streaming_file(std::string file_path)</a></code></p>
<p>Exemple :</p>
<p>``` #include "btsnoop/btsnoopparser.h"</p>
<p>.......... ..........</p>
<p><a class="el" href="class_bt_snoop_parser.html">BtSnoopParser</a> parser;</p>
<p><a class="el" href="class_bt_snoop_monitor.html">BtSnoopMonitor</a> monitor;</p>
<p>parser.addSnoopListener(&amp;monitor);</p>
<p>bool success = parser.decode_streaming_file("/path/to/your/file");</p>
<p>if (success){ //success } else{ //failure (bad reading / file not found) } ```</p>
<ul>
<li>You can block file monitoring process with <code>void <a class="el" href="class_bt_snoop_parser.html#a8830094180c497f1088f9dba5a4baefa" title="wait for thread to finish (blocking method) ">BtSnoopParser::join()</a>;</code> method</li>
</ul>
<h2>Datamodel description</h2>
<ul>
<li><code><a class="el" href="class_bt_snoop_task.html">BtSnoopTask</a></code> description :</li>
</ul>
<p>| method | type | description |-----------&mdash;|------&mdash;|--&mdash;|---------------------&mdash;| | <code>getFileInfo()</code> | <code><a class="el" href="class_bt_snoop_file_info.html">BtSnoopFileInfo</a></code> | retrieve file information | | <code>getPacketDataRecords()</code> | <code>std::vector&lt;<a class="el" href="class_bt_snoop_packet.html">BtSnoopPacket</a>&gt;</code> | retrieve list of packet record |</p>
<ul>
<li><code><a class="el" href="class_bt_snoop_file_info.html">BtSnoopFileInfo</a></code> description :</li>
</ul>
<p>| method | type | description |-----------&mdash;|------&mdash;|--&mdash;|---------------------&mdash;| | <code>getIdentificationNumber()</code> | <code>std::string</code> | get identification number | | <code>getVersionNumber()</code> | <code>int</code> | get snoop version number | | <code>getDatalinkNumber()</code> | <code>datalink_type</code> | get datalink enum | | <code>getDatalinkStr()</code> | <code>std::string</code> | get datalink name string |</p>
<ul>
<li><code><a class="el" href="class_bt_snoop_packet.html">BtSnoopPacket</a></code> description :</li>
</ul>
<p>| method | type | description |-----------&mdash;|------&mdash;|--&mdash;|---------------------&mdash;| | <code>getOriginalLength()</code> | <code>int</code> | get length of original packet | | <code>getincludedLength()</code> | <code>int</code> | get packet data field length | | <code>getCumulativeDrops()</code> | <code>int</code> | get number of packet lost between the first record and this record for this file | | <code>getUnixTimestampMicroseconds()</code> | <code>uint64_t</code> | get unix timestamp for this packet record | | <code>is_packet_sent()</code> | <code>bool</code> | define if packet record is sent | | <code>is_packet_received()</code> | <code>bool</code> | define if packet record is received | | <code>is_data()</code> | <code>bool</code> | define if packet record is data record | | <code>is_command_event()</code> | <code>bool</code> | define if packet record is command or event | | <code>getPacketData()</code> | <code>std::vector&lt;char&gt;</code> | get packet data records |</p>
<h2>Android integration</h2>
<p>An Android Makefile is provided for easy Android integration. Simply add the git repository as a submodule in your <code>jni</code> directory :</p>
<p>``` git submodule add <a href="https://github.com/akinaru/btsnoop-decoder.git">https://github.com/akinaru/btsnoop-decoder.git</a> &lt;yourproject/src/main/jni/btsnoop-decoder&gt; ```</p>
<p>In you <code>Application.mk</code> add gnustl support :</p>
<p>``` APP_STL := gnustl_static ```</p>
<p>If you dont use Android NDK rc10 change <code>Android.mk</code> std include with your own path in you android-ndk source :</p>
<p>``` LOCAL_C_INCLUDES := $NDK/sources/cxx-stl/gnu-libstdc++/4.8/include ```</p>
<h2>Examples</h2>
<p><a href="https://github.com/akinaru/btsnoop-decoder/blob/master/test/src/main.cpp">From test project in main.cpp</a></p>
<h2>Memory checking</h2>
<p>`` valgrind &ndash;tool=memcheck &ndash;leak-check=full ./bin/btsnoop-test ``</p>
<h2>Specifications</h2>
<p>snoop format V2 : <a href="https://tools.ietf.org/html/rfc1761">https://tools.ietf.org/html/rfc1761</a> </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.9.1 </li>
  </ul>
</div>
</body>
</html>
